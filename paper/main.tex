\documentclass[12pt]{article}

% Packages
\usepackage{amsmath, amssymb, amsthm}
\usepackage{geometry}
\usepackage{hyperref}
\usepackage{cleveref}
\usepackage{graphicx}
\usepackage{enumitem}
\usepackage{color}
\usepackage{mathtools}
\usepackage{tikz}
\usepackage{mathrsfs}

% Page Setup
\geometry{letterpaper, margin=1in}
\setlength{\parindent}{0pt} % No indent for paragraphs
\setlength{\parskip}{1em}   % Spacing between paragraphs

% Theorem Styles
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{remark}[theorem]{Remark}

% Commands
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\op}{\diamond}
\newcommand{\formaleq}{\simeq}
\newcommand{\eps}{\varepsilon}

% Title Information
\title{The Equational Theories Project}
\author{Author Names (in Alphabetical Order)}
\date{\today}

\begin{document}

\begin{abstract}  We report on the \emph{Equational Theories Project} (ETP), an online collaborative project to determine the implication graph between short equational laws on magmas, by a combination of human-generated and automated proofs, all validated by the formal proof assistant language \emph{Lean}.  {\bf state key outcomes}
\end{abstract}

\maketitle

\tableofcontents

\section{Introduction}

\subsection{Magmas and equational laws}

A \emph{magma} $M = (M,\op)$ is a set $M$ (known as the \emph{carrier}) together with a binary operation $\op \colon M \times M \to M$.  An \emph{equational law} for a magma, or \emph{law} for short, is an identity involving $\op$ and some indeterminates, which we will typically denote using the symbols $x,y,z,u,v,w$.  Familiar examples of equational laws include the \emph{commutative law}
\begin{equation}\label{eq43}\tag{E43}
    x \op y = y \op x
\end{equation}
and the \emph{associative law}
\begin{equation}\label{eq4512}\tag{E4512}
    (x \op y) \op z = x \op (y \op z).
\end{equation}
For our project we have assigned a unique number to each equational law, which we describe in \Cref{numbering-app}.  Formally, one can represent an equational law syntactically as a string $w_1 \formaleq w_2$, where $w_1, w_2$ are words in a free magma generated by formal indeterminate symbols; see ???.

A magma $M$ obeys a law $E$ if the law $E$ holds for all possible assignments of the indeterminate to $M$, in which case we write $M \models E$.  Thus for instance $M \models E43$ if one has $x \op y = y \op x$ for all $x,y \in M$.

We place a pre-order on laws by writing $E \leq E'$ or $E \vdash E'$ if every magma that obeys $E$, also implies $E'$: $(M \models E) \implies (M \models E')$.  We say that two laws are \emph{equivalent} if they imply each other.  For instance, the constant law
\begin{equation}\label{eq46}\tag{E46}
x \op y = z \op w
\end{equation}
can easily be see to be equivalent to the law
\begin{equation}\label{eq41}\tag{E41}
x \op x = y \op z.
\end{equation}
In this pre-ordering, a maximal element is given by the trivial law
\begin{equation}\label{eq1}\tag{E1}
x = x
\end{equation}
and a minimal element is given by the singleton law
\begin{equation}\label{eq2}\tag{E2}
x = y.
\end{equation}

The \emph{order} of an equational law is the number of occurrences of the magma operation.  For instance, the commutative law \eqref{eq43} has order $2$, while the associative law \eqref{eq4512} has order $4$.  We note some selected laws of small order that have previously appeared in the literature:
\begin{itemize}
\item The \emph{central groupoid law}
\begin{equation}\label{eq168}\tag{E168}
x = (y \op x) \op (x \op z)
\end{equation}
is an order $3$ law introduced by Evans \cite{evans} and studied further by Knuth \cite{knuth} and many further authors, being closely related to central digraphs (also known as unique path property diagraphs), and leading in particular to the discovery of the Knuth-Bendix algorithm \cite{knuth-bendix}; see \cite{klt} for a more recent survey
\item \emph{Tarski's axiom}
\begin{equation}\label{eq543}\tag{E543}
    x = y \op ( (z \op (x \op (y \op z))))
\end{equation}
is an order $4$ law that was shown by Tarski \cite{Tarski1938} to characterize the operation of subtraction in an abelian group; that is to say, a magma $M$ obeys \eqref{eq543} if and only if there is an abelian group structure on $M$ for which $x \op y = x-y$ for all $x,y \in M$.
\item In a similar vein, it was shown in \cite{mendelsohn-padmanabhan} that the order $4$ law
\begin{equation}\label{eq1571}\tag{E1571}
    x = (y \op z) \op (y \op (x \op z))
\end{equation}
characterizes addition (or subtraction) in an abelian group of exponent $2$; it was shown in \cite{mccune_et_al} that the order $4$ law
\begin{equation}\label{eq345169}\tag{E345169}
    x = (y \op ((x \op y) \op y)) \op (x \op (z \op y))
\end{equation}
characterizes the Sheffer stroke in a boolean algebra, and it was shown in \cite{higman-neumann} that the order $8$ law
\begin{equation}\label{eq42323216}\tag{E42323216}
x = y \op ((((y \op y) \op x) \op z) \op (((y \op y) \op y) \op z))
\end{equation}
characterizes division in a (not necessarily abelian) group.
\end{itemize}

The Birkhoff completeness theorem \cite[Th. 3.5.14]{term-rewriting} implies that an implication $E \vdash E'$ of equational laws holds if and only if the left hand side of $E'$ can be transformed into the right-hand side by a finite number of substitution rewrites using the law $E$.  However, the problem of determining whether such an implication holds is undecidable in general \cite{mckenzie}.Even when the order is small, some implications\footnote{Another contemperaneous example of this phenomenon was the solution of the Robbins problem \cite{robbins}.} can require lengthy computer-assisted proofs; for instance, it was noted in \cite{Kisielewicz2} that the order $4$ law
\begin{equation}\label{eq1689}\tag{E1689}
    x = (y \op x) \op ((x \op z) \op z)
\end{equation}
was equivalent to the singleton law \eqref{eq2}, but all known proofs are computer-assisted.

\subsection{The Equational Theories Project}

As noted in \Cref{numbering-app}, there are $4694$ equational laws of order at most $4$.  In September of 2024, we launched the \emph{Equational Theories Project} (ETP)\footnote{\url{https://teorth.github.io/equational_theories/}} to completely determine the implication pre-ordering $\leq$ for this set of laws.  Ostensibly, this determining the truth or falsity of $4694 \times 4693 = 22028942$ implications; while one can use properties such as the transitivity of the pre-ordering to reduce the work somewhat, this is clearly a task that requires significant automation.

MORE EXPLANATION HERE






\section{Results}
While a large number of theoretically interesting results are not expected, some notable ones can be listed here with links to blueprints/Lean as necessary. Proofs can be deferred to the appendix.

\begin{itemize}
    \item A new short Austin pair: Equation 3944 implies Equation 3588 \cite{finite_magmas}, but not for infinite magmas \cite{infinite_magmas}.
\end{itemize}

\section{Mathematical Foundations}
This section covers topics like free magmas (including those relative to theories), a completeness theorem, and confluence (unique simplification).

\section{Formal Foundations}
Here we describe the Lean framework used to formalize the project, covering technical issues such as:

\begin{itemize}
    \item Magma operation symbol issues
    \item Syntax (`LawX`) versus semantics (`EquationX`)
    \item "Universe hell" issues
    \item Additional verification (axiom checking, Leanchecker, etc.)
    \item Use of the `conjecture` keyword
\end{itemize}

\subsection{Contributions to Mathlib}
None yet, but presumably, some of what we do will be uploadable and should be mentioned.

\section{Project Management}
Shreyas Srinivas and Pietro Monticone have volunteered to take the lead on this section.

Discuss topics such as:
\begin{itemize}
    \item Project generation from \href{https://github.com/pitmonticone/LeanProject}{template}
    \item Github issue management with \href{https://github.com/teorth/equational_theories/labels}{labels} and \href{https://github.com/users/teorth/projects/1}{task management dashboard}
    \item Continuous integration (builds, blueprint compilation, task status transition)
    \item Pre-push git hooks
    \item Use of Lean Zulip and polls
\end{itemize}

\subsection{Handling Scaling Issues}
Mention early human-managed efforts and the need for forethought in setting up a GitHub organizational structure. Discuss the use of transitive reduction to keep the Lean codebase manageable.

\subsection{Other Design Considerations}
Explain the meaning of "trusting Lean" in a large project and highlight human issues that may arise, tools for external checks, PR reviews, and good practices like branch protection.

\section{Finite Magmas and Other Sources of Counterexamples}
Describe various sources of example magmas, including finite and linear magmas, and their role in ruling out implications. Also, discuss the computational and memory efficiencies needed.

\section{Metatheorems}
List some notable metatheorems, including those that did not mature in time for deployment but may still be useful in the future.

\section{Automated Theorem Proving}
Describe the automated theorem provers used in the project (Z3, Vampire, egg, etc.) and performance statistics. Explore semi-automated vs. fully automated methods and how these were integrated into the project.

\section{AI-assisted Contributions}
Current contributions include Claudeâ€™s assistance with front-end coding, with potential for more as the project progresses.

\section{User Interface}
Describe visualizations and explorer tools used in the project.

\section{Statistics and Experiments}
Analyze the implication graph and discuss test sets of implication problems for benchmarking theorem provers. Challenge: How can one automatically assign a difficulty level to an implication?

\section{Data Management}
Describe how data was handled during the project and how it will be managed going forward.

\section{Reflections}
Include testimonies from participants and reflections on the project, discussing the balance between automation and human input.

\section{Conclusions and Future Directions}
Summarize insights and future directions for the project, including potential databases and interesting equational laws.

\section*{Acknowledgments}
Acknowledgments to the broader Lean Zulip community and smaller contributors not listed as authors.

\appendix

\section{Numbering system}\label{numbering-app}

In this section we record the numbering conventions we use for equational laws.

For this formal definition we use the natural numbers $0,1,2,\dots$ to represent and order indeterminate variables; however, in the main text, we use the symbols $x,y,z,w,u,v,r,s,t$ instead (and do not consider any laws with more than eight variables).

We requiring extend the ordering on indeterminate variables to a well-ordering on words $w$ in the free magma generated by these variables by declaring $w > w'$ if one of the following holds:
\begin{itemize}
    \item $w$ has a larger order than $w'$.
    \item $w = w_1 \op w_2$ and $w' = w'_1 \op w'_2$ have the same order $n \geq 1$ with $w_1 > w'_1$.
    \item $w = w_1 \op w_2$ and $w' = w'_1 \op w'_2$ have the same order $n \geq 1$ with $w_1 = w'_1$ and $w_2 > w'_2$.
\end{itemize}
Thus for instance
$$ 0 < 1 < 0 \op 0 < 0 \op 1 < 1 \op 0 $$
and
$$ 1 \op 1 < 0 \op (0 \op 0) < (0 \op 0) \op 0.$$

We similarly place a well-ordering on equational laws $w_1 \formaleq w_2$ by declaring $w_1 \formaleq w_2 > w'_1 \formaleq w'_2$ if one of the following holds:
as follows:
\begin{itemize}
\item  $w_1 \formaleq w_2$ has a longer order than $w'_1 \formaleq w'_2$.
\item If $w_1 \formaleq w_2$ has the same order as $w'_1 \formaleq w'_2$, and $w_1 > w'_1$.
\item If $w_1 \formaleq w_2$ has the same order as $w'_1 \formaleq w'_2$, $w_1 = w'_1$, and $w_2 > w'_2$.
\end{itemize}

Two equational laws are equivalent if one can be obtained from another by some combination of relabeling the variables and applying the symmetric law $w_1 \formaleq w_2 \iff w_2 \formaleq w_1$.  For instance, $(0 \op 1) \op 2 \formaleq 1$ is equivalent to $0 \formaleq (1 \op 0) \op 2$.  We then eliminate all equational laws that are not minimal in their equivalence class; for instance, we would eliminate $(0 \op 1) \op 2 \formaleq 1$ in favor of $0 \formaleq (1 \op 0) \op 2$.  Finally, we eliminate any law of the form $w \formaleq w$ other than $0 \formaleq 0$.  We then number the remaining equations $E1, E2, \dots$.  For instance, $E1$ is the trivial law $0 \formaleq 0$, $E2$ is the constant law $0 \formaleq 1$, $E3$ is the idempotent law $0 \formaleq 0 \op 0$, and so forth.  Lists and code for generating these equations, or the equation number attached to a given equation, can be found at the ETP repository.

The number of equations in this list of order $n=0,1,2,\dots$ is given by
$$ 2, 5, 39, 364, 4284, 57882, 888365, \dots$$
(\url{https://oeis.org/A376640}).  The number can be computed to be
$$ C_{n+1} B_{n+2}/2$$
if $n$ is odd, $2$ if $n=0$, and
$$ (C_{n+1} B_{n+2}+ C_{n/2}(2D_{n+2}-B_{n+2}))/2 - C_{n/2} B_{n/2+1}$$
if $n > 2$ is even, where $C_n, B_n$ are the Catalan and Bell numbers, and $D_n$ is the number of partitions of $[n]$ up to reflection, which for $n=0,1,2,\dots$ is
$$ 1, 1, 2, 4, 11, 32, 117, \dots$$
(\url{https://oeis.org/A103293}).  A proof of this claim can be found in the ETP blueprint.  In particular, there are $4694$ equations of order at most $4$.



\section{Proofs of Theoretical Results}
Provide the interesting proofs mentioned in the results section, while routine proofs can refer to the blueprint or Lean.

\section{Author Contributions}
List author contributions, using CRediT categories. Elaborate on how these categories are interpreted and add affiliations and grant acknowledgments.

\bibliographystyle{plain}
\bibliography{references}

\end{document}
